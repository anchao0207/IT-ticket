generator client {
  provider        = "prisma-client"
  output          = "./generated"
  engineType      = "client"
}

datasource db {
  provider = "postgresql"
}

// Ticket Relationship: One Admin has many Tickets
// Ticket Relationship: One Admin has many Tickets
model ticket {
  id          Int       @id @default(autoincrement())
  date        DateTime  @default(now())
  startedTime DateTime
  company     String
  location    String
  person      String
  issue       String
  resolution  String?
  comments    String?
  timeEnd     DateTime?
  totalTime   Float?
  status      String    @default("Unassigned")
  
  // Relations
  adminId     Int?
  admin       admin?    @relation(fields: [adminId], references: [id])

  // New Relations
  clientId    Int?
  client      client?   @relation(fields: [clientId], references: [id])
  assetSerial String?
  asset       asset?    @relation(fields: [assetSerial], references: [serialNumber])
}

model client {
  id          Int      @id @default(autoincrement())
  name        String   @unique
  contactInfo String?
  phone       String?
  address     String?
  
  assets      asset[]
  tickets     ticket[]
}

model asset {
  serialNumber String    @id
  name         String
  type         String
  description  String?
  status       String    @default("In Storage")
  purchaseDate DateTime?
  
  // Relations
  clientId     Int?
  client       client?   @relation(fields: [clientId], references: [id])
  tickets      ticket[]
}

model timelog {
  id         Int       @id @default(autoincrement())
  date       DateTime  @default(now())
  timeIn     DateTime
  timeOut    DateTime?
  lunchStart DateTime?
  lunchEnd   DateTime?
  mileage    Float?    @default(0.0)

  // Relations
  adminId Int?
  admin   admin? @relation(fields: [adminId], references: [id])
}

model admin {
  id       Int      @id @default(autoincrement())
  username String   @unique
  password String
  name     String
  tickets  ticket[]
  timelogs timelog[]
}
